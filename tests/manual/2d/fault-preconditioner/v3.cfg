[pylithapp]
dump_parameters.filename = output/v3_twocells-parameters.json
problem.progress_monitor.filename = output/v3_twocells-progress.txt

problem.defaults.name = v3_twocells

# ----------------------------------------------------------------------
# journal
# ----------------------------------------------------------------------
[pylithapp.journal.info]
#timedependent = 1
#solution = 1
#petsc = 1
#meshio = 1
#isotropiclinearelasticity = 1
#dirichlettimedependent = 1
#faultcohesivekin = 1

[pylithapp.journal.debug]
#timedependent = 1
#solution = 1
#isotropiclinearelasticity = 1
#dirichlettimedependent = 1
#constraintspatialdb = 1
#faultcohesivekin = 1
#integratorinterface = 1
#kinsrcstep = 1
#outputphysics = 1
#outputsolndomain = 1

# ----------------------------------------------------------------------
# mesh_generator
# ----------------------------------------------------------------------
[pylithapp.mesh_generator]
reader = pylith.meshio.MeshIOAscii

[pylithapp.mesh_generator.reader]
filename = quad_twocells.mesh
coordsys.space_dim = 2

# ----------------------------------------------------------------------
# problem
# ----------------------------------------------------------------------
[pylithapp.problem]
initial_dt = 10.0*year
start_time = -10.0*year
end_time = 0.0*year

# ----------------------------------------------------------------------
# solution
# ----------------------------------------------------------------------
[pylithapp.problem]
solution = pylith.problems.SolnDispLagrange

defaults.quadrature_order = 1
#solver = nonlinear ; Use nonlinear solver to ensure residual and Jacobian are consistent.

[pylithapp.problem.solution.subfields]
displacement.basis_order = 1
lagrange_fault.basis_order = 1

[pylithapp.problem]
solution_observers = [domain]

# ----------------------------------------------------------------------
# materials
# ----------------------------------------------------------------------
[pylithapp.problem]
materials = [elastic]

[pylithapp.problem.materials.elastic]
label = Elastic material
id = 0

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.label = Elastic properties
db_auxiliary_field.values = [density, vs, vp]
db_auxiliary_field.data = [2500*kg/m**3, 3.0*km/s, 5.2915026*km/s]


auxiliary_subfields.density.basis_order = 0
bulk_rheology.auxiliary_subfields.bulk_modulus.basis_order = 0
bulk_rheology.auxiliary_subfields.shear_modulus.basis_order = 0


# ----------------------------------------------------------------------
# fault
# ----------------------------------------------------------------------
[pylithapp.problem]
interfaces = [fault]

[pylithapp.problem.interfaces.fault]
id = 10
label = fault

observers.observer.data_fields = [slip]

[pylithapp.problem.interfaces.fault.eq_ruptures.rupture]
db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.label = Fault rupture auxiliary field spatial database
db_auxiliary_field.values = [initiation_time, final_slip_left_lateral, final_slip_opening]
db_auxiliary_field.data = [0.0*s, -2.0*m, 0.0*m]


# ----------------------------------------------------------------------
# boundary conditions
# ----------------------------------------------------------------------
[pylithapp.problem]
bc = [bc_xneg, bc_xpos]
bc.bc_xneg = pylith.bc.DirichletTimeDependent
bc.bc_xpos = pylith.bc.DirichletTimeDependent

[pylithapp.problem.bc.bc_xpos]
constrained_dof = [0, 1]
label = bc_xpos
db_auxiliary_field = pylith.bc.ZeroDB
#db_auxiliary_field = spatialdata.spatialdb.UniformDB
#db_auxiliary_field.label = Dirichlet BC +x edge
#db_auxiliary_field.values = [initial_amplitude_x, initial_amplitude_y]
#db_auxiliary_field.data = [0.0*m, -1.0*m]

[pylithapp.problem.bc.bc_xneg]
constrained_dof = [0, 1]
label = bc_xneg
db_auxiliary_field = pylith.bc.ZeroDB
#db_auxiliary_field = spatialdata.spatialdb.UniformDB
#db_auxiliary_field.label = Dirichlet BC +x edge
#db_auxiliary_field.values = [initial_amplitude_x, initial_amplitude_y]
#db_auxiliary_field.data = [0.0*m, +1.0*m]

# ----------------------------------------------------------------------
# PETSc
# ----------------------------------------------------------------------
[pylithapp.petsc]
ts_type = beuler

pc_type = fieldsplit
pc_use_amat = true
pc_fieldsplit_type = schur


fieldsplit_displacement_pc_type = ml
#fieldsplit_displacement_pc_type = lu
fieldsplit_displacement_ksp_type = preonly


#fieldsplit_lagrange_multiplier_fault_ksp_view_pmat = true
#fieldsplit_lagrange_multiplier_fault_ksp_view_preconditioned_operator_explicit = true


# End of file
